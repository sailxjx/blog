
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>multipart 到底是个啥玩意儿 - CodeBean</title>
	<meta name="author" content="Xu Jingxin">

	
	<meta name="description" content="在 POST 请求中，常见的几种请求头有 ‘application/x-www-form-urlencoded’， ‘application/json’，这些都很容易理解，唯独 ‘multipart/form-data’ 这种请求挺让我费解，下面就来详细说明一下，以作笔记备查。 在 GET 请求中 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/blog/atom.xml" rel="alternate" title="CodeBean" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/blog/favicon.ico" rel="shortcut icon">
	<link href="/blog/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/blog/">CodeBean</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/blog/">Blog</a></li>
	<li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/blog/">Blog</a></li>
	<li><a href="/blog/blog/archives">Archives</a></li>
</ul>

</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:jingxin.me/blog">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/102588932744890343699?rel=author" title="Google+">Google+</a>
		
		
		
		<a class="github" href="https://github.com/sailxjx" title="GitHub">GitHub</a>
		
		
		
		
		
		<a class="rss" href="/blog/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="https://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:jingxin.me/blog">
	</form>
</nav>

</header>
	
		

	
	<div id="content" class="inner"><article class="post">
	<h1 class="title">Multipart 到底是个啥玩意儿</h1>
	<div class="entry-content"><p>在 POST 请求中，常见的几种请求头有 ‘application/x-www-form-urlencoded’， ‘application/json’，这些都很容易理解，唯独 ‘multipart/form-data’ 这种请求挺让我费解，下面就来详细说明一下，以作笔记备查。</p>

<p>在 GET 请求中，参数一般会以 ‘&amp;’ 为分割符号，比如 ‘http://api.example.com?name=tom&amp;friend=jerry’，在 ‘application/x-www-form-urlencoded’ 类的 POST 请求中，参数形式与此类似，只不过参数被写在了 body 中，以突破 url 中 2k 字节的限制。</p>

<p>而当我们想上传文件或其他二进制数据时，根据 form 标准，非字符串会被替换成 ‘%HH’，其中的 ‘HH’ 是两个十六进制数来表示当前这位的二进制数据。在上传大文件的时候，这种做法就显得非常浪费了。于是，我们经常会把 ‘multipart/form-data’ 来用在文件上传中。</p>

<p>我们来看一个完整的 ‘multipart/form-data’ 请求：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
</pre></td><td class="code"><pre><code class=""><span class="line">Content-Type: multipart/form-data; boundary=AaB03x
</span><span class="line">
</span><span class="line">--AaB03x
</span><span class="line">Content-Disposition: form-data; name="submit-name"
</span><span class="line">
</span><span class="line">Larry
</span><span class="line">--AaB03x
</span><span class="line">Content-Disposition: form-data; name="files"; filename="file1.txt"
</span><span class="line">Content-Type: text/plain
</span><span class="line">
</span><span class="line">... contents of file1.txt ...
</span><span class="line">--AaB03x--</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>上面 ‘boundary’ 的值，就与常见的 ‘application/x-www-form-urlencoded’ 中 ‘&amp;’ 的作用差不多了，在接收请求的服务器中，会将 body 以 ‘–AaB03x’ 分割出一个个 part，就能正常解析出参数类型，名称，文件名等等内容了。</p>

<h1 id="section">参考资料</h1>

<ul>
  <li><a href="http://www.w3.org/Protocols/rfc1341/7_2_Multipart.html">The Multipart Content-Type</a></li>
  <li><a href="http://www.w3.org/TR/html401/interact/forms.html">Forms</a></li>
  <li><a href="http://stackoverflow.com/questions/4007969/application-x-www-form-urlencoded-or-multipart-form-data">application/x-www-form-urlencoded or multipart/form-data?</a></li>
</ul>

</div>


<div class="meta">
	<div class="date">








  



<time datetime="2014-12-21T11:16:00+08:00" pubdate data-updated="true">2014.12.21</time></div>
	<div class="tags">


	<a class='category' href='/blog/blog/categories/http/'>http</a>, <a class='category' href='/blog/blog/categories/multipart/'>multipart</a>, <a class='category' href='/blog/blog/categories/restful/'>restful</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	
	<a class="addthis_counter addthis_pill_style"></a>
	</div>
  <script type="text/javascript" src="https://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>



<section id="comment">
    <h1 class="title">Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2016

    Xu Jingxin


</footer>
	<script src="/blog/javascripts/jquery-2.1.1.min.js"></script>
<script src="/blog/javascripts/slash.js"></script>


<script type="text/javascript">
      var disqus_shortname = 'sailxjx';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://jingxin.me/blog/blog/2014/12/21/multipart-dao-di-shi-ge-sha-wan-yi-er/';
        var disqus_url = 'http://jingxin.me/blog/blog/2014/12/21/multipart-dao-di-shi-ge-sha-wan-yi-er/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>




</body>
</html>